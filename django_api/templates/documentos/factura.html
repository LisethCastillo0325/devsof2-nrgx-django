
{% extends 'documentos/base/index.html' %}

{% block title %} Factura {% endblock %}


{% block estilo_personalizado %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style type="text/css">
        #cabecera > div {font-size: 12px !important; }
        .card-height-all {width: 100%; !important;}
    </style>
{% endblock %}

{% load static %}

{% block content %}

    <div id="cabecera" class="row">
        <div class="col-2 justify-content-start align-items-center">
            <img
                src="{{data.url_api}}static/img/logo-2.jpeg"
                alt="logo_finamiga"
                class="img-fluid"
            />
        </div>
        <div class="col-6 ">
            <div class="row">
                <p>
                    NRG-X Nit:789.258.002-3 <br>
                    <b>{{data.contrato.cliente.full_name | upper}}</b><br>
                    {{data.contrato.cliente.identification_type.label | upper}} {{data.contrato.cliente.identification_number}} <br>
                    {{data.contrato.direccion_instalacion | upper}}<br>
                    {{data.contrato.ciudad.label | upper}}
                </p>
            </div>
            <div class="row">
                <div class="card">
                    <div class="card-body">
                        Factura No: {{data.id}}<br> 
                        Número de Pago Electronico: {{data.numero_pago_electronico}} <br>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-4 d-flex justify-content-end">
            <div class="card card-height-all">
                <div class="card-body d-flex align-items-center">
                    
                    <table width="100%" border="0">
                        <tr>
                            <td>CONTRATO</td>
                            <td>{{data.contrato.id}}</td>
                        </tr>
                        <tr class="text-bg-primary rounded" width="100%">
                            <td>TOTAL A PAGAR</td>
                            <td>{{data.total_a_pagar}}</td>
                        </tr>
                        <tr>
                            <td>FECHA DE EXPEDICIÓN</td>
                            <td>{{data.fecha_expedicion}}</td>
                        </tr>
                        <tr>
                            <td>FECHA DE VENCIMIENTO</td>
                            <td>{{data.fecha_vencimiento}}</td>
                        </tr>
                    </table>


                </div>
            </div>
        </div>
    </div>

    {% if data.publicidad_seccion_a %}
        <div class="row" style="margin-top: 10px;">
            <div class="col">
                <img width="100%" height="200"
                        src="{{data.url_api}}{{data.publicidad_seccion_a.imagen.url}}"
                        alt={{data.publicidad_seccion_a.nombre}}
                        class="rounded"
                    />
            </div>
        </div>
    {% endif %}

    {% for detalle  in data.detalle_factura %}
    
        <div class="card" style="margin-top: 10px;">
            <div class="card-header">
                <strong>{{ detalle.servicio.nombre }}</strong>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col col-md-3">
                        Uso: {{ data.contrato.tipo_de_uso.label }} <br>
                        Estrato: {{ data.contrato.estrato }}<br>
                        Lecturra Actual: {{ detalle.lectura_actual }}<br>
                        Lecturra Anterior: {{ detalle.lectura_anterior }}<br>
                        Diferencia: {{ detalle.consumo_actual }}<br>
                        Consumo Actual: {{ detalle.consumo_actual }} {{ detalle.servicio.unidad_medida.label }}<br>
                    </div>

                    <div class="col col-md-9">
                        <table class="table" style="width: 100%;" >
                            <caption>Detalle Factura</caption>
                            <thead>
                                <th>Cancepto</th>
                                <th>Cantidad</th>
                                <th>Valor Unitario</th>
                                <th>Total a Pagar</th>
                            </thead>
                            <tbody>
                                <td>Consumo</td>
                                <td>{{ detalle.consumo_actual }}</td>
                                <td>{{ detalle.valor_unitario }}</td>
                                <td>{{ detalle.valor_total }}</td>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    {% endfor %}

    <div class="row" style="margin-top: 25px; ">
        <div class="col-5  justify-content-end"> 
            <div class="card">
                <div class="card-header">
                    <strong>TOTAL A PAGAR ESTE MES</strong>
                </div>
                <div class="card-body">
                    <table class="table table-borderless" style="width: 100%;" >
                        <tr>
                            <th width="70%">Total Servicios</th>
                            <td align="right">{{data.total_servicios}}</td>
                        </tr>
                        <tr>
                            <th>+ Cuentas Vencidas</th>
                            <td align="right">{{data.valor_pendiente_pago}}</td>
                        </tr>
                        <tr>
                            <th>+ Recargo Mora {{data.porcentaje_recargo}} </th>
                            <td align="right">{{data.valor_recargo}}</td>
                        </tr>
                    </table>
                </div>
                <div class="card-footer">
                    <table class="table table-borderless" style="width: 100%;" >
                        <tr>
                            <th width="70%">TOTAL A PAGAR</th>
                            <td align="right">{{data.total_a_pagar}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <br>

    <div class="row" style="margin-top: 10px;">
        {% if data.publicidad_seccion_b %}
            <div class="col-8">
                <img width="100%" height="200"
                        src="{{data.url_api}}{{data.publicidad_seccion_b.imagen.url}}"
                        alt={{data.publicidad_seccion_b.nombre}}
                        class=" rounded"
                    />
            </div>
        {% endif %}
        {% if data.publicidad_seccion_c %}
            <div class="col-4">
                <img width="100%" height="200"
                        src="{{data.url_api}}{{data.publicidad_seccion_c.imagen.url}}"
                        alt={{data.publicidad_seccion_c.nombre}}
                        class=" rounded"
                    />
            </div>
        {% endif %}
    </div>

    {% for pub in data.publicidad_otros  %}
        <div style="margin-bottom: 10px;">
            <img width="100%"
                src="{{data.url_api}}{{pub.imagen.url}}"
                alt={{pub.nombre}}
                class="img-fluid rounded"
            />
        </div>
    {% endfor %}

{% endblock %}